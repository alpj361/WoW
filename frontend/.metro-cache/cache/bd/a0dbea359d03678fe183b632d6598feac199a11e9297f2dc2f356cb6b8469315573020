{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"processRecurringDates\", {\n    enumerable: true,\n    get: function () {\n      return processRecurringDates;\n    }\n  });\n  /**\n   * Process recurring event dates to set the closest future date as main date\n   * and remaining future dates as recurring_dates.\n   *\n   * For recurring events: IGNORE the main date field (often wrong from AI) and use only recurring_dates.\n   * For non-recurring events: use the main date.\n   *\n   * @param mainDateStr - The main date from analysis (format: YYYY-MM-DD or DD-MM-YYYY)\n   * @param recurringDatesStr - Array of recurring dates (format: YYYY-MM-DD)\n   * @param isRecurringEvent - Whether the event is marked as recurring\n   * @returns { mainDate: Date | null, recurringDates: Date[], isRecurring: boolean }\n   */\n  const processRecurringDates = (mainDateStr, recurringDatesStr, isRecurringEvent = false) => {\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n\n    // Helper to parse a date string (handles YYYY-MM-DD and DD-MM-YYYY)\n    const parseDate = dateStr => {\n      const parts = dateStr.split(/[-/]/).map(Number);\n      if (parts.length === 3) {\n        let year, month, day;\n        if (parts[0] > 1000) {\n          // YYYY-MM-DD\n          [year, month, day] = parts;\n        } else {\n          // DD-MM-YYYY\n          [day, month, year] = parts;\n        }\n        const date = new Date(year, month - 1, day);\n        return isNaN(date.getTime()) ? null : date;\n      } else if (parts.length === 2) {\n        // DD-MM format, add current year\n        const currentYear = new Date().getFullYear();\n        const [day, month] = parts;\n        const date = new Date(currentYear, month - 1, day);\n        return isNaN(date.getTime()) ? null : date;\n      }\n      return null;\n    };\n\n    // For recurring events with recurring_dates: ONLY use recurring_dates (ignore mainDateStr)\n    // The AI often puts wrong dates in the main date field for recurring events\n    if (isRecurringEvent && recurringDatesStr && recurringDatesStr.length > 0) {\n      const recurringParsed = [];\n      for (const dateStr of recurringDatesStr) {\n        const date = parseDate(dateStr);\n        if (date) recurringParsed.push(date);\n      }\n      if (recurringParsed.length > 0) {\n        // Sort all dates\n        recurringParsed.sort((a, b) => a.getTime() - b.getTime());\n\n        // Filter future dates\n        const futureDates = recurringParsed.filter(d => d >= today);\n        if (futureDates.length > 0) {\n          // First future date is main, rest are recurring\n          return {\n            mainDate: futureDates[0],\n            recurringDates: futureDates.slice(1),\n            isRecurring: futureDates.length > 1\n          };\n        } else {\n          // All dates in past - use the last (most recent) one\n          return {\n            mainDate: recurringParsed[recurringParsed.length - 1],\n            recurringDates: recurringParsed.slice(0, -1),\n            isRecurring: recurringParsed.length > 1\n          };\n        }\n      }\n    }\n\n    // Non-recurring event or no recurring_dates: just use main date\n    if (mainDateStr && mainDateStr !== 'No especificado') {\n      const mainDate = parseDate(mainDateStr);\n      if (mainDate) {\n        return {\n          mainDate,\n          recurringDates: [],\n          isRecurring: false\n        };\n      }\n    }\n    return {\n      mainDate: null,\n      recurringDates: [],\n      isRecurring: false\n    };\n  };\n});","lineCount":102,"map":[[7,2,13,0,"Object"],[7,8,13,0],[7,9,13,0,"defineProperty"],[7,23,13,0],[7,24,13,0,"exports"],[7,31,13,0],[8,4,13,0,"enumerable"],[8,14,13,0],[9,4,13,0,"get"],[9,7,13,0],[9,18,13,0,"get"],[9,19,13,0],[10,6,13,0],[10,13,13,0,"processRecurringDates"],[10,34,13,0],[11,4,13,0],[12,2,13,0],[13,2,1,0],[14,0,2,0],[15,0,3,0],[16,0,4,0],[17,0,5,0],[18,0,6,0],[19,0,7,0],[20,0,8,0],[21,0,9,0],[22,0,10,0],[23,0,11,0],[24,0,12,0],[25,2,13,7],[25,8,13,13,"processRecurringDates"],[25,29,13,34],[25,32,13,37,"processRecurringDates"],[25,33,14,4,"mainDateStr"],[25,44,14,42],[25,46,15,4,"recurringDatesStr"],[25,63,15,50],[25,65,16,4,"isRecurringEvent"],[25,81,16,29],[25,84,16,32],[25,89,16,37],[25,94,17,78],[26,4,18,4],[26,10,18,10,"today"],[26,15,18,15],[26,18,18,18],[26,22,18,22,"Date"],[26,26,18,26],[26,27,18,27],[26,28,18,28],[27,4,19,4,"today"],[27,9,19,9],[27,10,19,10,"setHours"],[27,18,19,18],[27,19,19,19],[27,20,19,20],[27,22,19,22],[27,23,19,23],[27,25,19,25],[27,26,19,26],[27,28,19,28],[27,29,19,29],[27,30,19,30],[29,4,21,4],[30,4,22,4],[30,10,22,10,"parseDate"],[30,19,22,19],[30,22,22,23,"dateStr"],[30,29,22,38],[30,33,22,56],[31,6,23,8],[31,12,23,14,"parts"],[31,17,23,19],[31,20,23,22,"dateStr"],[31,27,23,29],[31,28,23,30,"split"],[31,33,23,35],[31,34,23,36],[31,40,23,42],[31,41,23,43],[31,42,23,44,"map"],[31,45,23,47],[31,46,23,48,"Number"],[31,52,23,54],[31,53,23,55],[32,6,24,8],[32,10,24,12,"parts"],[32,15,24,17],[32,16,24,18,"length"],[32,22,24,24],[32,27,24,29],[32,28,24,30],[32,30,24,32],[33,8,25,12],[33,12,25,16,"year"],[33,16,25,28],[33,18,25,30,"month"],[33,23,25,43],[33,25,25,45,"day"],[33,28,25,56],[34,8,26,12],[34,12,26,16,"parts"],[34,17,26,21],[34,18,26,22],[34,19,26,23],[34,20,26,24],[34,23,26,27],[34,27,26,31],[34,29,26,33],[35,10,27,16],[36,10,28,16],[36,11,28,17,"year"],[36,15,28,21],[36,17,28,23,"month"],[36,22,28,28],[36,24,28,30,"day"],[36,27,28,33],[36,28,28,34],[36,31,28,37,"parts"],[36,36,28,42],[37,8,29,12],[37,9,29,13],[37,15,29,19],[38,10,30,16],[39,10,31,16],[39,11,31,17,"day"],[39,14,31,20],[39,16,31,22,"month"],[39,21,31,27],[39,23,31,29,"year"],[39,27,31,33],[39,28,31,34],[39,31,31,37,"parts"],[39,36,31,42],[40,8,32,12],[41,8,33,12],[41,14,33,18,"date"],[41,18,33,22],[41,21,33,25],[41,25,33,29,"Date"],[41,29,33,33],[41,30,33,34,"year"],[41,34,33,38],[41,36,33,40,"month"],[41,41,33,45],[41,44,33,48],[41,45,33,49],[41,47,33,51,"day"],[41,50,33,54],[41,51,33,55],[42,8,34,12],[42,15,34,19,"isNaN"],[42,20,34,24],[42,21,34,25,"date"],[42,25,34,29],[42,26,34,30,"getTime"],[42,33,34,37],[42,34,34,38],[42,35,34,39],[42,36,34,40],[42,39,34,43],[42,43,34,47],[42,46,34,50,"date"],[42,50,34,54],[43,6,35,8],[43,7,35,9],[43,13,35,15],[43,17,35,19,"parts"],[43,22,35,24],[43,23,35,25,"length"],[43,29,35,31],[43,34,35,36],[43,35,35,37],[43,37,35,39],[44,8,36,12],[45,8,37,12],[45,14,37,18,"currentYear"],[45,25,37,29],[45,28,37,32],[45,32,37,36,"Date"],[45,36,37,40],[45,37,37,41],[45,38,37,42],[45,39,37,43,"getFullYear"],[45,50,37,54],[45,51,37,55],[45,52,37,56],[46,8,38,12],[46,14,38,18],[46,15,38,19,"day"],[46,18,38,22],[46,20,38,24,"month"],[46,25,38,29],[46,26,38,30],[46,29,38,33,"parts"],[46,34,38,38],[47,8,39,12],[47,14,39,18,"date"],[47,18,39,22],[47,21,39,25],[47,25,39,29,"Date"],[47,29,39,33],[47,30,39,34,"currentYear"],[47,41,39,45],[47,43,39,47,"month"],[47,48,39,52],[47,51,39,55],[47,52,39,56],[47,54,39,58,"day"],[47,57,39,61],[47,58,39,62],[48,8,40,12],[48,15,40,19,"isNaN"],[48,20,40,24],[48,21,40,25,"date"],[48,25,40,29],[48,26,40,30,"getTime"],[48,33,40,37],[48,34,40,38],[48,35,40,39],[48,36,40,40],[48,39,40,43],[48,43,40,47],[48,46,40,50,"date"],[48,50,40,54],[49,6,41,8],[50,6,42,8],[50,13,42,15],[50,17,42,19],[51,4,43,4],[51,5,43,5],[53,4,45,4],[54,4,46,4],[55,4,47,4],[55,8,47,8,"isRecurringEvent"],[55,24,47,24],[55,28,47,28,"recurringDatesStr"],[55,45,47,45],[55,49,47,49,"recurringDatesStr"],[55,66,47,66],[55,67,47,67,"length"],[55,73,47,73],[55,76,47,76],[55,77,47,77],[55,79,47,79],[56,6,48,8],[56,12,48,14,"recurringParsed"],[56,27,48,37],[56,30,48,40],[56,32,48,42],[57,6,49,8],[57,11,49,13],[57,17,49,19,"dateStr"],[57,24,49,26],[57,28,49,30,"recurringDatesStr"],[57,45,49,47],[57,47,49,49],[58,8,50,12],[58,14,50,18,"date"],[58,18,50,22],[58,21,50,25,"parseDate"],[58,30,50,34],[58,31,50,35,"dateStr"],[58,38,50,42],[58,39,50,43],[59,8,51,12],[59,12,51,16,"date"],[59,16,51,20],[59,18,51,22,"recurringParsed"],[59,33,51,37],[59,34,51,38,"push"],[59,38,51,42],[59,39,51,43,"date"],[59,43,51,47],[59,44,51,48],[60,6,52,8],[61,6,54,8],[61,10,54,12,"recurringParsed"],[61,25,54,27],[61,26,54,28,"length"],[61,32,54,34],[61,35,54,37],[61,36,54,38],[61,38,54,40],[62,8,55,12],[63,8,56,12,"recurringParsed"],[63,23,56,27],[63,24,56,28,"sort"],[63,28,56,32],[63,29,56,33],[63,30,56,34,"a"],[63,31,56,35],[63,33,56,37,"b"],[63,34,56,38],[63,39,56,43,"a"],[63,40,56,44],[63,41,56,45,"getTime"],[63,48,56,52],[63,49,56,53],[63,50,56,54],[63,53,56,57,"b"],[63,54,56,58],[63,55,56,59,"getTime"],[63,62,56,66],[63,63,56,67],[63,64,56,68],[63,65,56,69],[65,8,58,12],[66,8,59,12],[66,14,59,18,"futureDates"],[66,25,59,29],[66,28,59,32,"recurringParsed"],[66,43,59,47],[66,44,59,48,"filter"],[66,50,59,54],[66,51,59,55,"d"],[66,52,59,56],[66,56,59,60,"d"],[66,57,59,61],[66,61,59,65,"today"],[66,66,59,70],[66,67,59,71],[67,8,61,12],[67,12,61,16,"futureDates"],[67,23,61,27],[67,24,61,28,"length"],[67,30,61,34],[67,33,61,37],[67,34,61,38],[67,36,61,40],[68,10,62,16],[69,10,63,16],[69,17,63,23],[70,12,64,20,"mainDate"],[70,20,64,28],[70,22,64,30,"futureDates"],[70,33,64,41],[70,34,64,42],[70,35,64,43],[70,36,64,44],[71,12,65,20,"recurringDates"],[71,26,65,34],[71,28,65,36,"futureDates"],[71,39,65,47],[71,40,65,48,"slice"],[71,45,65,53],[71,46,65,54],[71,47,65,55],[71,48,65,56],[72,12,66,20,"isRecurring"],[72,23,66,31],[72,25,66,33,"futureDates"],[72,36,66,44],[72,37,66,45,"length"],[72,43,66,51],[72,46,66,54],[73,10,67,16],[73,11,67,17],[74,8,68,12],[74,9,68,13],[74,15,68,19],[75,10,69,16],[76,10,70,16],[76,17,70,23],[77,12,71,20,"mainDate"],[77,20,71,28],[77,22,71,30,"recurringParsed"],[77,37,71,45],[77,38,71,46,"recurringParsed"],[77,53,71,61],[77,54,71,62,"length"],[77,60,71,68],[77,63,71,71],[77,64,71,72],[77,65,71,73],[78,12,72,20,"recurringDates"],[78,26,72,34],[78,28,72,36,"recurringParsed"],[78,43,72,51],[78,44,72,52,"slice"],[78,49,72,57],[78,50,72,58],[78,51,72,59],[78,53,72,61],[78,54,72,62],[78,55,72,63],[78,56,72,64],[79,12,73,20,"isRecurring"],[79,23,73,31],[79,25,73,33,"recurringParsed"],[79,40,73,48],[79,41,73,49,"length"],[79,47,73,55],[79,50,73,58],[80,10,74,16],[80,11,74,17],[81,8,75,12],[82,6,76,8],[83,4,77,4],[85,4,79,4],[86,4,80,4],[86,8,80,8,"mainDateStr"],[86,19,80,19],[86,23,80,23,"mainDateStr"],[86,34,80,34],[86,39,80,39],[86,56,80,56],[86,58,80,58],[87,6,81,8],[87,12,81,14,"mainDate"],[87,20,81,22],[87,23,81,25,"parseDate"],[87,32,81,34],[87,33,81,35,"mainDateStr"],[87,44,81,46],[87,45,81,47],[88,6,82,8],[88,10,82,12,"mainDate"],[88,18,82,20],[88,20,82,22],[89,8,83,12],[89,15,83,19],[90,10,83,21,"mainDate"],[90,18,83,29],[91,10,83,31,"recurringDates"],[91,24,83,45],[91,26,83,47],[91,28,83,49],[92,10,83,51,"isRecurring"],[92,21,83,62],[92,23,83,64],[93,8,83,70],[93,9,83,71],[94,6,84,8],[95,4,85,4],[96,4,87,4],[96,11,87,11],[97,6,87,13,"mainDate"],[97,14,87,21],[97,16,87,23],[97,20,87,27],[98,6,87,29,"recurringDates"],[98,20,87,43],[98,22,87,45],[98,24,87,47],[99,6,87,49,"isRecurring"],[99,17,87,60],[99,19,87,62],[100,4,87,68],[100,5,87,69],[101,2,88,0],[101,3,88,1],[102,0,88,2],[102,3]],"functionMap":{"names":["<global>","processRecurringDates","parseDate","recurringParsed.sort$argument_0","recurringParsed.filter$argument_0"],"mappings":"AAA;qCCY;sBCS;KDqB;iCEa,mCF;uDGG,eH;CD6B"},"hasCjsExports":false},"type":"js/module"}]}