{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":78,"index":78}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"../services/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":134},"end":{"line":3,"column":70,"index":204}}],"key":"KPiafkkHXMyy0AQm6tuLQc7uw64=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/Users/pj/Desktop/Wow/frontend/src/context/AuthContext.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.AuthProvider = AuthProvider;\n  exports.useAuth = useAuth;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _servicesSupabase = require(_dependencyMap[1], \"../services/supabase\");\n  var _reactJsxDevRuntime = require(_dependencyMap[2], \"react/jsx-dev-runtime\");\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  function AuthProvider({\n    children\n  }) {\n    const [session, setSession] = (0, _react.useState)(null);\n    const [user, setUser] = (0, _react.useState)(null);\n    const [profile, setProfile] = (0, _react.useState)(null);\n    const [loading, setLoading] = (0, _react.useState)(true);\n    (0, _react.useEffect)(() => {\n      if (!(0, _servicesSupabase.isSupabaseConfigured)()) {\n        console.log('âš ï¸ Supabase not configured');\n        setLoading(false);\n        return;\n      }\n\n      // Get initial session\n      _servicesSupabase.supabase.auth.getSession().then(async ({\n        data: {\n          session\n        }\n      }) => {\n        console.log('ðŸ” Initial session:', session?.user?.email);\n        setSession(session);\n        if (session?.user) {\n          // Check if user has a profile (is registered)\n          const hasProfile = await fetchProfile(session.user.id);\n          if (hasProfile) {\n            setUser(session.user);\n          } else {\n            // User authenticated but NOT registered - sign them out\n            console.log('âŒ User not registered, signing out');\n            await _servicesSupabase.supabase.auth.signOut();\n            setUser(null);\n            setSession(null);\n          }\n        }\n        setLoading(false);\n      });\n\n      // Listen for auth changes\n      const {\n        data: {\n          subscription\n        }\n      } = _servicesSupabase.supabase.auth.onAuthStateChange(async (event, session) => {\n        console.log('ðŸ” Auth state change:', event, session?.user?.email);\n        setSession(session);\n        if (session?.user) {\n          // Check if user has a profile\n          const hasProfile = await fetchProfile(session.user.id);\n          if (hasProfile) {\n            setUser(session.user);\n          } else {\n            // User authenticated but NOT registered\n            console.log('âŒ User has no profile, not setting user');\n            // Don't sign out here - let the auth flow handle it\n            // But don't set user either - this prevents navigation to home\n            setUser(null);\n            setLoading(false);\n          }\n        } else {\n          setUser(null);\n          setProfile(null);\n          setLoading(false);\n        }\n      });\n      return () => subscription.unsubscribe();\n    }, []);\n\n    // Returns true if profile exists, false otherwise\n    const fetchProfile = async userId => {\n      try {\n        console.log('ðŸ” Fetching profile for:', userId);\n        const {\n          data,\n          error\n        } = await _servicesSupabase.supabase.from('profiles').select('*').eq('id', userId).single();\n        if (data && !error) {\n          console.log('âœ… Profile found:', data.email);\n          setProfile(data);\n          return true;\n        } else {\n          console.log('âŒ No profile found');\n          setProfile(null);\n          return false;\n        }\n      } catch (error) {\n        console.error('Error fetching profile:', error);\n        setProfile(null);\n        return false;\n      }\n    };\n    const signOut = async () => {\n      try {\n        setSession(null);\n        setUser(null);\n        setProfile(null);\n        await _servicesSupabase.supabase.auth.signOut();\n      } catch (error) {\n        console.error('Error signing out:', error);\n      }\n    };\n    const value = {\n      session,\n      user,\n      profile,\n      loading,\n      signOut\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: value,\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 12\n    }, this);\n  }\n  function useAuth() {\n    const context = (0, _react.useContext)(AuthContext);\n    if (context === undefined) {\n      throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n  }\n});","lineCount":138,"map":[[8,2,15,0,"exports"],[8,9,15,0],[8,10,15,0,"AuthProvider"],[8,22,15,0],[8,25,15,0,"AuthProvider"],[8,37,15,0],[9,2,127,0,"exports"],[9,9,127,0],[9,10,127,0,"useAuth"],[9,17,127,0],[9,20,127,0,"useAuth"],[9,27,127,0],[10,2,1,0],[10,6,1,0,"_react"],[10,12,1,0],[10,15,1,0,"require"],[10,22,1,0],[10,23,1,0,"_dependencyMap"],[10,37,1,0],[11,2,3,0],[11,6,3,0,"_servicesSupabase"],[11,23,3,0],[11,26,3,0,"require"],[11,33,3,0],[11,34,3,0,"_dependencyMap"],[11,48,3,0],[12,2,3,70],[12,6,3,70,"_reactJsxDevRuntime"],[12,25,3,70],[12,28,3,70,"require"],[12,35,3,70],[12,36,3,70,"_dependencyMap"],[12,50,3,70],[13,2,13,0],[13,8,13,6,"AuthContext"],[13,19,13,17],[13,35,13,20],[13,39,13,20,"createContext"],[13,45,13,33],[13,46,13,33,"createContext"],[13,59,13,33],[13,61,13,63,"undefined"],[13,70,13,72],[13,71,13,73],[14,2,15,7],[14,11,15,16,"AuthProvider"],[14,23,15,28,"AuthProvider"],[14,24,15,29],[15,4,15,31,"children"],[16,2,15,71],[16,3,15,72],[16,5,15,74],[17,4,16,4],[17,10,16,10],[17,11,16,11,"session"],[17,18,16,18],[17,20,16,20,"setSession"],[17,30,16,30],[17,31,16,31],[17,34,16,34],[17,38,16,34,"useState"],[17,44,16,42],[17,45,16,42,"useState"],[17,53,16,42],[17,55,16,59],[17,59,16,63],[17,60,16,64],[18,4,17,4],[18,10,17,10],[18,11,17,11,"user"],[18,15,17,15],[18,17,17,17,"setUser"],[18,24,17,24],[18,25,17,25],[18,28,17,28],[18,32,17,28,"useState"],[18,38,17,36],[18,39,17,36,"useState"],[18,47,17,36],[18,49,17,50],[18,53,17,54],[18,54,17,55],[19,4,18,4],[19,10,18,10],[19,11,18,11,"profile"],[19,18,18,18],[19,20,18,20,"setProfile"],[19,30,18,30],[19,31,18,31],[19,34,18,34],[19,38,18,34,"useState"],[19,44,18,42],[19,45,18,42,"useState"],[19,53,18,42],[19,55,18,55],[19,59,18,59],[19,60,18,60],[20,4,19,4],[20,10,19,10],[20,11,19,11,"loading"],[20,18,19,18],[20,20,19,20,"setLoading"],[20,30,19,30],[20,31,19,31],[20,34,19,34],[20,38,19,34,"useState"],[20,44,19,42],[20,45,19,42,"useState"],[20,53,19,42],[20,55,19,43],[20,59,19,47],[20,60,19,48],[21,4,21,4],[21,8,21,4,"useEffect"],[21,14,21,13],[21,15,21,13,"useEffect"],[21,24,21,13],[21,26,21,14],[21,32,21,20],[22,6,22,8],[22,10,22,12],[22,11,22,13],[22,15,22,13,"isSupabaseConfigured"],[22,32,22,33],[22,33,22,33,"isSupabaseConfigured"],[22,53,22,33],[22,55,22,34],[22,56,22,35],[22,58,22,37],[23,8,23,12,"console"],[23,15,23,19],[23,16,23,20,"log"],[23,19,23,23],[23,20,23,24],[23,48,23,52],[23,49,23,53],[24,8,24,12,"setLoading"],[24,18,24,22],[24,19,24,23],[24,24,24,28],[24,25,24,29],[25,8,25,12],[26,6,26,8],[28,6,28,8],[29,6,29,8,"supabase"],[29,23,29,16],[29,24,29,16,"supabase"],[29,32,29,16],[29,33,29,17,"auth"],[29,37,29,21],[29,38,29,22,"getSession"],[29,48,29,32],[29,49,29,33],[29,50,29,34],[29,51,29,35,"then"],[29,55,29,39],[29,56,29,40],[29,63,29,47],[30,8,29,49,"data"],[30,12,29,53],[30,14,29,55],[31,10,29,57,"session"],[32,8,29,65],[33,6,29,67],[33,7,29,68],[33,12,29,73],[34,8,30,12,"console"],[34,15,30,19],[34,16,30,20,"log"],[34,19,30,23],[34,20,30,24],[34,41,30,45],[34,43,30,47,"session"],[34,50,30,54],[34,52,30,56,"user"],[34,56,30,60],[34,58,30,62,"email"],[34,63,30,67],[34,64,30,68],[35,8,31,12,"setSession"],[35,18,31,22],[35,19,31,23,"session"],[35,26,31,30],[35,27,31,31],[36,8,33,12],[36,12,33,16,"session"],[36,19,33,23],[36,21,33,25,"user"],[36,25,33,29],[36,27,33,31],[37,10,34,16],[38,10,35,16],[38,16,35,22,"hasProfile"],[38,26,35,32],[38,29,35,35],[38,35,35,41,"fetchProfile"],[38,47,35,53],[38,48,35,54,"session"],[38,55,35,61],[38,56,35,62,"user"],[38,60,35,66],[38,61,35,67,"id"],[38,63,35,69],[38,64,35,70],[39,10,36,16],[39,14,36,20,"hasProfile"],[39,24,36,30],[39,26,36,32],[40,12,37,20,"setUser"],[40,19,37,27],[40,20,37,28,"session"],[40,27,37,35],[40,28,37,36,"user"],[40,32,37,40],[40,33,37,41],[41,10,38,16],[41,11,38,17],[41,17,38,23],[42,12,39,20],[43,12,40,20,"console"],[43,19,40,27],[43,20,40,28,"log"],[43,23,40,31],[43,24,40,32],[43,60,40,68],[43,61,40,69],[44,12,41,20],[44,18,41,26,"supabase"],[44,35,41,34],[44,36,41,34,"supabase"],[44,44,41,34],[44,45,41,35,"auth"],[44,49,41,39],[44,50,41,40,"signOut"],[44,57,41,47],[44,58,41,48],[44,59,41,49],[45,12,42,20,"setUser"],[45,19,42,27],[45,20,42,28],[45,24,42,32],[45,25,42,33],[46,12,43,20,"setSession"],[46,22,43,30],[46,23,43,31],[46,27,43,35],[46,28,43,36],[47,10,44,16],[48,8,45,12],[49,8,46,12,"setLoading"],[49,18,46,22],[49,19,46,23],[49,24,46,28],[49,25,46,29],[50,6,47,8],[50,7,47,9],[50,8,47,10],[52,6,49,8],[53,6,50,8],[53,12,50,14],[54,8,50,16,"data"],[54,12,50,20],[54,14,50,22],[55,10,50,24,"subscription"],[56,8,50,37],[57,6,50,39],[57,7,50,40],[57,10,50,43,"supabase"],[57,27,50,51],[57,28,50,51,"supabase"],[57,36,50,51],[57,37,50,52,"auth"],[57,41,50,56],[57,42,50,57,"onAuthStateChange"],[57,59,50,74],[57,60,51,12],[57,67,51,19,"event"],[57,72,51,24],[57,74,51,26,"session"],[57,81,51,33],[57,86,51,38],[58,8,52,16,"console"],[58,15,52,23],[58,16,52,24,"log"],[58,19,52,27],[58,20,52,28],[58,43,52,51],[58,45,52,53,"event"],[58,50,52,58],[58,52,52,60,"session"],[58,59,52,67],[58,61,52,69,"user"],[58,65,52,73],[58,67,52,75,"email"],[58,72,52,80],[58,73,52,81],[59,8,53,16,"setSession"],[59,18,53,26],[59,19,53,27,"session"],[59,26,53,34],[59,27,53,35],[60,8,55,16],[60,12,55,20,"session"],[60,19,55,27],[60,21,55,29,"user"],[60,25,55,33],[60,27,55,35],[61,10,56,20],[62,10,57,20],[62,16,57,26,"hasProfile"],[62,26,57,36],[62,29,57,39],[62,35,57,45,"fetchProfile"],[62,47,57,57],[62,48,57,58,"session"],[62,55,57,65],[62,56,57,66,"user"],[62,60,57,70],[62,61,57,71,"id"],[62,63,57,73],[62,64,57,74],[63,10,58,20],[63,14,58,24,"hasProfile"],[63,24,58,34],[63,26,58,36],[64,12,59,24,"setUser"],[64,19,59,31],[64,20,59,32,"session"],[64,27,59,39],[64,28,59,40,"user"],[64,32,59,44],[64,33,59,45],[65,10,60,20],[65,11,60,21],[65,17,60,27],[66,12,61,24],[67,12,62,24,"console"],[67,19,62,31],[67,20,62,32,"log"],[67,23,62,35],[67,24,62,36],[67,65,62,77],[67,66,62,78],[68,12,63,24],[69,12,64,24],[70,12,65,24,"setUser"],[70,19,65,31],[70,20,65,32],[70,24,65,36],[70,25,65,37],[71,12,66,24,"setLoading"],[71,22,66,34],[71,23,66,35],[71,28,66,40],[71,29,66,41],[72,10,67,20],[73,8,68,16],[73,9,68,17],[73,15,68,23],[74,10,69,20,"setUser"],[74,17,69,27],[74,18,69,28],[74,22,69,32],[74,23,69,33],[75,10,70,20,"setProfile"],[75,20,70,30],[75,21,70,31],[75,25,70,35],[75,26,70,36],[76,10,71,20,"setLoading"],[76,20,71,30],[76,21,71,31],[76,26,71,36],[76,27,71,37],[77,8,72,16],[78,6,73,12],[78,7,74,8],[78,8,74,9],[79,6,76,8],[79,13,76,15],[79,19,76,21,"subscription"],[79,31,76,33],[79,32,76,34,"unsubscribe"],[79,43,76,45],[79,44,76,46],[79,45,76,47],[80,4,77,4],[80,5,77,5],[80,7,77,7],[80,9,77,9],[80,10,77,10],[82,4,79,4],[83,4,80,4],[83,10,80,10,"fetchProfile"],[83,22,80,22],[83,25,80,25],[83,31,80,32,"userId"],[83,37,80,46],[83,41,80,69],[84,6,81,8],[84,10,81,12],[85,8,82,12,"console"],[85,15,82,19],[85,16,82,20,"log"],[85,19,82,23],[85,20,82,24],[85,46,82,50],[85,48,82,52,"userId"],[85,54,82,58],[85,55,82,59],[86,8,83,12],[86,14,83,18],[87,10,83,20,"data"],[87,14,83,24],[88,10,83,26,"error"],[89,8,83,32],[89,9,83,33],[89,12,83,36],[89,18,83,42,"supabase"],[89,35,83,50],[89,36,83,50,"supabase"],[89,44,83,50],[89,45,84,17,"from"],[89,49,84,21],[89,50,84,22],[89,60,84,32],[89,61,84,33],[89,62,85,17,"select"],[89,68,85,23],[89,69,85,24],[89,72,85,27],[89,73,85,28],[89,74,86,17,"eq"],[89,76,86,19],[89,77,86,20],[89,81,86,24],[89,83,86,26,"userId"],[89,89,86,32],[89,90,86,33],[89,91,87,17,"single"],[89,97,87,23],[89,98,87,24],[89,99,87,25],[90,8,89,12],[90,12,89,16,"data"],[90,16,89,20],[90,20,89,24],[90,21,89,25,"error"],[90,26,89,30],[90,28,89,32],[91,10,90,16,"console"],[91,17,90,23],[91,18,90,24,"log"],[91,21,90,27],[91,22,90,28],[91,40,90,46],[91,42,90,48,"data"],[91,46,90,52],[91,47,90,53,"email"],[91,52,90,58],[91,53,90,59],[92,10,91,16,"setProfile"],[92,20,91,26],[92,21,91,27,"data"],[92,25,91,31],[92,26,91,32],[93,10,92,16],[93,17,92,23],[93,21,92,27],[94,8,93,12],[94,9,93,13],[94,15,93,19],[95,10,94,16,"console"],[95,17,94,23],[95,18,94,24,"log"],[95,21,94,27],[95,22,94,28],[95,42,94,48],[95,43,94,49],[96,10,95,16,"setProfile"],[96,20,95,26],[96,21,95,27],[96,25,95,31],[96,26,95,32],[97,10,96,16],[97,17,96,23],[97,22,96,28],[98,8,97,12],[99,6,98,8],[99,7,98,9],[99,8,98,10],[99,15,98,17,"error"],[99,20,98,22],[99,22,98,24],[100,8,99,12,"console"],[100,15,99,19],[100,16,99,20,"error"],[100,21,99,25],[100,22,99,26],[100,47,99,51],[100,49,99,53,"error"],[100,54,99,58],[100,55,99,59],[101,8,100,12,"setProfile"],[101,18,100,22],[101,19,100,23],[101,23,100,27],[101,24,100,28],[102,8,101,12],[102,15,101,19],[102,20,101,24],[103,6,102,8],[104,4,103,4],[104,5,103,5],[105,4,105,4],[105,10,105,10,"signOut"],[105,17,105,17],[105,20,105,20],[105,26,105,20,"signOut"],[105,27,105,20],[105,32,105,32],[106,6,106,8],[106,10,106,12],[107,8,107,12,"setSession"],[107,18,107,22],[107,19,107,23],[107,23,107,27],[107,24,107,28],[108,8,108,12,"setUser"],[108,15,108,19],[108,16,108,20],[108,20,108,24],[108,21,108,25],[109,8,109,12,"setProfile"],[109,18,109,22],[109,19,109,23],[109,23,109,27],[109,24,109,28],[110,8,110,12],[110,14,110,18,"supabase"],[110,31,110,26],[110,32,110,26,"supabase"],[110,40,110,26],[110,41,110,27,"auth"],[110,45,110,31],[110,46,110,32,"signOut"],[110,53,110,39],[110,54,110,40],[110,55,110,41],[111,6,111,8],[111,7,111,9],[111,8,111,10],[111,15,111,17,"error"],[111,20,111,22],[111,22,111,24],[112,8,112,12,"console"],[112,15,112,19],[112,16,112,20,"error"],[112,21,112,25],[112,22,112,26],[112,42,112,46],[112,44,112,48,"error"],[112,49,112,53],[112,50,112,54],[113,6,113,8],[114,4,114,4],[114,5,114,5],[115,4,116,4],[115,10,116,10,"value"],[115,15,116,15],[115,18,116,18],[116,6,117,8,"session"],[116,13,117,15],[117,6,118,8,"user"],[117,10,118,12],[118,6,119,8,"profile"],[118,13,119,15],[119,6,120,8,"loading"],[119,13,120,15],[120,6,121,8,"signOut"],[121,4,122,4],[121,5,122,5],[122,4,124,4],[122,24,124,11],[122,28,124,11,"_reactJsxDevRuntime"],[122,47,124,11],[122,48,124,11,"jsxDEV"],[122,54,124,11],[122,56,124,12,"AuthContext"],[122,67,124,23],[122,68,124,24,"Provider"],[122,76,124,32],[123,6,124,33,"value"],[123,11,124,38],[123,13,124,40,"value"],[123,18,124,46],[124,6,124,46,"children"],[124,14,124,46],[124,16,124,48,"children"],[125,4,124,56],[126,6,124,56,"fileName"],[126,14,124,56],[126,16,124,56,"_jsxFileName"],[126,28,124,56],[127,6,124,56,"lineNumber"],[127,16,124,56],[128,6,124,56,"columnNumber"],[128,18,124,56],[129,4,124,56],[129,11,124,79],[129,12,124,80],[130,2,125,0],[131,2,127,7],[131,11,127,16,"useAuth"],[131,18,127,23,"useAuth"],[131,19,127,23],[131,21,127,26],[132,4,128,4],[132,10,128,10,"context"],[132,17,128,17],[132,20,128,20],[132,24,128,20,"useContext"],[132,30,128,30],[132,31,128,30,"useContext"],[132,41,128,30],[132,43,128,31,"AuthContext"],[132,54,128,42],[132,55,128,43],[133,4,129,4],[133,8,129,8,"context"],[133,15,129,15],[133,20,129,20,"undefined"],[133,29,129,29],[133,31,129,31],[134,6,130,8],[134,12,130,14],[134,16,130,18,"Error"],[134,21,130,23],[134,22,130,24],[134,67,130,69],[134,68,130,70],[135,4,131,4],[136,4,132,4],[136,11,132,11,"context"],[136,18,132,18],[137,2,133,0],[138,0,133,1],[138,3]],"functionMap":{"names":["<global>","AuthProvider","useEffect$argument_0","supabase.auth.getSession.then$argument_0","supabase.auth.onAuthStateChange$argument_0","<anonymous>","fetchProfile","signOut","useAuth"],"mappings":"AAA;OCc;cCM;wCCQ;SDkB;YEI;aFsB;eGG,gCH;KDC;yBKG;KLuB;oBME;KNS;CDW;OQE;CRM"},"hasCjsExports":false},"type":"js/module"}]}