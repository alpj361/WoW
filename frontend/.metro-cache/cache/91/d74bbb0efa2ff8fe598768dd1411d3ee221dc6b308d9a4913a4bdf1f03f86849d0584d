{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":78,"index":78}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"../services/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":134},"end":{"line":3,"column":70,"index":204}}],"key":"KPiafkkHXMyy0AQm6tuLQc7uw64=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/Users/pj/Desktop/Wow/frontend/src/context/AuthContext.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.AuthProvider = AuthProvider;\n  exports.useAuth = useAuth;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _servicesSupabase = require(_dependencyMap[1], \"../services/supabase\");\n  var _reactJsxDevRuntime = require(_dependencyMap[2], \"react/jsx-dev-runtime\");\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  function AuthProvider({\n    children\n  }) {\n    _s();\n    const [session, setSession] = (0, _react.useState)(null);\n    const [user, setUser] = (0, _react.useState)(null);\n    const [profile, setProfile] = (0, _react.useState)(null);\n    const [loading, setLoading] = (0, _react.useState)(true);\n    (0, _react.useEffect)(() => {\n      if (!(0, _servicesSupabase.isSupabaseConfigured)()) {\n        console.log('âš ï¸ Supabase not configured');\n        setLoading(false);\n        return;\n      }\n\n      // Get initial session\n      _servicesSupabase.supabase.auth.getSession().then(async ({\n        data: {\n          session\n        }\n      }) => {\n        console.log('ðŸ” Initial session:', session?.user?.email);\n        setSession(session);\n        if (session?.user) {\n          // Check if user has a profile (is registered)\n          const hasProfile = await fetchProfile(session.user.id);\n          if (hasProfile) {\n            setUser(session.user);\n          } else {\n            // User authenticated but NOT registered - sign them out\n            console.log('âŒ User not registered, signing out');\n            await _servicesSupabase.supabase.auth.signOut();\n            setUser(null);\n            setSession(null);\n          }\n        }\n        setLoading(false);\n      });\n\n      // Listen for auth changes\n      const {\n        data: {\n          subscription\n        }\n      } = _servicesSupabase.supabase.auth.onAuthStateChange(async (event, session) => {\n        console.log('ðŸ” Auth state change:', event, session?.user?.email);\n        setSession(session);\n        if (session?.user) {\n          // Check if user has a profile\n          const hasProfile = await fetchProfile(session.user.id);\n          if (hasProfile) {\n            setUser(session.user);\n          } else {\n            // User authenticated but NOT registered\n            console.log('âŒ User has no profile, not setting user');\n            // Don't sign out here - let the auth flow handle it\n            // But don't set user either - this prevents navigation to home\n            setUser(null);\n            setLoading(false);\n          }\n        } else {\n          setUser(null);\n          setProfile(null);\n          setLoading(false);\n        }\n      });\n      return () => subscription.unsubscribe();\n    }, []);\n\n    // Returns true if profile exists, false otherwise\n    const fetchProfile = async userId => {\n      try {\n        console.log('ðŸ” Fetching profile for:', userId);\n        const {\n          data,\n          error\n        } = await _servicesSupabase.supabase.from('profiles').select('*').eq('id', userId).single();\n        if (data && !error) {\n          console.log('âœ… Profile found:', data.email);\n          setProfile(data);\n          return true;\n        } else {\n          console.log('âŒ No profile found');\n          setProfile(null);\n          return false;\n        }\n      } catch (error) {\n        console.error('Error fetching profile:', error);\n        setProfile(null);\n        return false;\n      }\n    };\n    const signOut = async () => {\n      try {\n        setSession(null);\n        setUser(null);\n        setProfile(null);\n        await _servicesSupabase.supabase.auth.signOut();\n      } catch (error) {\n        console.error('Error signing out:', error);\n      }\n    };\n    const value = {\n      session,\n      user,\n      profile,\n      loading,\n      signOut\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: value,\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 12\n    }, this);\n  }\n  _s(AuthProvider, \"irauaxMOEWjG1lICmTthQs+tY9I=\");\n  _c = AuthProvider;\n  function useAuth() {\n    _s2();\n    const context = (0, _react.useContext)(AuthContext);\n    if (context === undefined) {\n      throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n  }\n  _s2(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\n  var _c;\n  $RefreshReg$(_c, \"AuthProvider\");\n});","lineCount":147,"map":[[10,2,15,0,"exports"],[10,9,15,0],[10,10,15,0,"AuthProvider"],[10,22,15,0],[10,25,15,0,"AuthProvider"],[10,37,15,0],[11,2,127,0,"exports"],[11,9,127,0],[11,10,127,0,"useAuth"],[11,17,127,0],[11,20,127,0,"useAuth"],[11,27,127,0],[12,2,1,0],[12,6,1,0,"_react"],[12,12,1,0],[12,15,1,0,"require"],[12,22,1,0],[12,23,1,0,"_dependencyMap"],[12,37,1,0],[13,2,3,0],[13,6,3,0,"_servicesSupabase"],[13,23,3,0],[13,26,3,0,"require"],[13,33,3,0],[13,34,3,0,"_dependencyMap"],[13,48,3,0],[14,2,3,70],[14,6,3,70,"_reactJsxDevRuntime"],[14,25,3,70],[14,28,3,70,"require"],[14,35,3,70],[14,36,3,70,"_dependencyMap"],[14,50,3,70],[15,2,13,0],[15,8,13,6,"AuthContext"],[15,19,13,17],[15,35,13,20],[15,39,13,20,"createContext"],[15,45,13,33],[15,46,13,33,"createContext"],[15,59,13,33],[15,61,13,63,"undefined"],[15,70,13,72],[15,71,13,73],[16,2,15,7],[16,11,15,16,"AuthProvider"],[16,23,15,28,"AuthProvider"],[16,24,15,29],[17,4,15,31,"children"],[18,2,15,71],[18,3,15,72],[18,5,15,74],[19,4,15,74,"_s"],[19,6,15,74],[20,4,16,4],[20,10,16,10],[20,11,16,11,"session"],[20,18,16,18],[20,20,16,20,"setSession"],[20,30,16,30],[20,31,16,31],[20,34,16,34],[20,38,16,34,"useState"],[20,44,16,42],[20,45,16,42,"useState"],[20,53,16,42],[20,55,16,59],[20,59,16,63],[20,60,16,64],[21,4,17,4],[21,10,17,10],[21,11,17,11,"user"],[21,15,17,15],[21,17,17,17,"setUser"],[21,24,17,24],[21,25,17,25],[21,28,17,28],[21,32,17,28,"useState"],[21,38,17,36],[21,39,17,36,"useState"],[21,47,17,36],[21,49,17,50],[21,53,17,54],[21,54,17,55],[22,4,18,4],[22,10,18,10],[22,11,18,11,"profile"],[22,18,18,18],[22,20,18,20,"setProfile"],[22,30,18,30],[22,31,18,31],[22,34,18,34],[22,38,18,34,"useState"],[22,44,18,42],[22,45,18,42,"useState"],[22,53,18,42],[22,55,18,55],[22,59,18,59],[22,60,18,60],[23,4,19,4],[23,10,19,10],[23,11,19,11,"loading"],[23,18,19,18],[23,20,19,20,"setLoading"],[23,30,19,30],[23,31,19,31],[23,34,19,34],[23,38,19,34,"useState"],[23,44,19,42],[23,45,19,42,"useState"],[23,53,19,42],[23,55,19,43],[23,59,19,47],[23,60,19,48],[24,4,21,4],[24,8,21,4,"useEffect"],[24,14,21,13],[24,15,21,13,"useEffect"],[24,24,21,13],[24,26,21,14],[24,32,21,20],[25,6,22,8],[25,10,22,12],[25,11,22,13],[25,15,22,13,"isSupabaseConfigured"],[25,32,22,33],[25,33,22,33,"isSupabaseConfigured"],[25,53,22,33],[25,55,22,34],[25,56,22,35],[25,58,22,37],[26,8,23,12,"console"],[26,15,23,19],[26,16,23,20,"log"],[26,19,23,23],[26,20,23,24],[26,48,23,52],[26,49,23,53],[27,8,24,12,"setLoading"],[27,18,24,22],[27,19,24,23],[27,24,24,28],[27,25,24,29],[28,8,25,12],[29,6,26,8],[31,6,28,8],[32,6,29,8,"supabase"],[32,23,29,16],[32,24,29,16,"supabase"],[32,32,29,16],[32,33,29,17,"auth"],[32,37,29,21],[32,38,29,22,"getSession"],[32,48,29,32],[32,49,29,33],[32,50,29,34],[32,51,29,35,"then"],[32,55,29,39],[32,56,29,40],[32,63,29,47],[33,8,29,49,"data"],[33,12,29,53],[33,14,29,55],[34,10,29,57,"session"],[35,8,29,65],[36,6,29,67],[36,7,29,68],[36,12,29,73],[37,8,30,12,"console"],[37,15,30,19],[37,16,30,20,"log"],[37,19,30,23],[37,20,30,24],[37,41,30,45],[37,43,30,47,"session"],[37,50,30,54],[37,52,30,56,"user"],[37,56,30,60],[37,58,30,62,"email"],[37,63,30,67],[37,64,30,68],[38,8,31,12,"setSession"],[38,18,31,22],[38,19,31,23,"session"],[38,26,31,30],[38,27,31,31],[39,8,33,12],[39,12,33,16,"session"],[39,19,33,23],[39,21,33,25,"user"],[39,25,33,29],[39,27,33,31],[40,10,34,16],[41,10,35,16],[41,16,35,22,"hasProfile"],[41,26,35,32],[41,29,35,35],[41,35,35,41,"fetchProfile"],[41,47,35,53],[41,48,35,54,"session"],[41,55,35,61],[41,56,35,62,"user"],[41,60,35,66],[41,61,35,67,"id"],[41,63,35,69],[41,64,35,70],[42,10,36,16],[42,14,36,20,"hasProfile"],[42,24,36,30],[42,26,36,32],[43,12,37,20,"setUser"],[43,19,37,27],[43,20,37,28,"session"],[43,27,37,35],[43,28,37,36,"user"],[43,32,37,40],[43,33,37,41],[44,10,38,16],[44,11,38,17],[44,17,38,23],[45,12,39,20],[46,12,40,20,"console"],[46,19,40,27],[46,20,40,28,"log"],[46,23,40,31],[46,24,40,32],[46,60,40,68],[46,61,40,69],[47,12,41,20],[47,18,41,26,"supabase"],[47,35,41,34],[47,36,41,34,"supabase"],[47,44,41,34],[47,45,41,35,"auth"],[47,49,41,39],[47,50,41,40,"signOut"],[47,57,41,47],[47,58,41,48],[47,59,41,49],[48,12,42,20,"setUser"],[48,19,42,27],[48,20,42,28],[48,24,42,32],[48,25,42,33],[49,12,43,20,"setSession"],[49,22,43,30],[49,23,43,31],[49,27,43,35],[49,28,43,36],[50,10,44,16],[51,8,45,12],[52,8,46,12,"setLoading"],[52,18,46,22],[52,19,46,23],[52,24,46,28],[52,25,46,29],[53,6,47,8],[53,7,47,9],[53,8,47,10],[55,6,49,8],[56,6,50,8],[56,12,50,14],[57,8,50,16,"data"],[57,12,50,20],[57,14,50,22],[58,10,50,24,"subscription"],[59,8,50,37],[60,6,50,39],[60,7,50,40],[60,10,50,43,"supabase"],[60,27,50,51],[60,28,50,51,"supabase"],[60,36,50,51],[60,37,50,52,"auth"],[60,41,50,56],[60,42,50,57,"onAuthStateChange"],[60,59,50,74],[60,60,51,12],[60,67,51,19,"event"],[60,72,51,24],[60,74,51,26,"session"],[60,81,51,33],[60,86,51,38],[61,8,52,16,"console"],[61,15,52,23],[61,16,52,24,"log"],[61,19,52,27],[61,20,52,28],[61,43,52,51],[61,45,52,53,"event"],[61,50,52,58],[61,52,52,60,"session"],[61,59,52,67],[61,61,52,69,"user"],[61,65,52,73],[61,67,52,75,"email"],[61,72,52,80],[61,73,52,81],[62,8,53,16,"setSession"],[62,18,53,26],[62,19,53,27,"session"],[62,26,53,34],[62,27,53,35],[63,8,55,16],[63,12,55,20,"session"],[63,19,55,27],[63,21,55,29,"user"],[63,25,55,33],[63,27,55,35],[64,10,56,20],[65,10,57,20],[65,16,57,26,"hasProfile"],[65,26,57,36],[65,29,57,39],[65,35,57,45,"fetchProfile"],[65,47,57,57],[65,48,57,58,"session"],[65,55,57,65],[65,56,57,66,"user"],[65,60,57,70],[65,61,57,71,"id"],[65,63,57,73],[65,64,57,74],[66,10,58,20],[66,14,58,24,"hasProfile"],[66,24,58,34],[66,26,58,36],[67,12,59,24,"setUser"],[67,19,59,31],[67,20,59,32,"session"],[67,27,59,39],[67,28,59,40,"user"],[67,32,59,44],[67,33,59,45],[68,10,60,20],[68,11,60,21],[68,17,60,27],[69,12,61,24],[70,12,62,24,"console"],[70,19,62,31],[70,20,62,32,"log"],[70,23,62,35],[70,24,62,36],[70,65,62,77],[70,66,62,78],[71,12,63,24],[72,12,64,24],[73,12,65,24,"setUser"],[73,19,65,31],[73,20,65,32],[73,24,65,36],[73,25,65,37],[74,12,66,24,"setLoading"],[74,22,66,34],[74,23,66,35],[74,28,66,40],[74,29,66,41],[75,10,67,20],[76,8,68,16],[76,9,68,17],[76,15,68,23],[77,10,69,20,"setUser"],[77,17,69,27],[77,18,69,28],[77,22,69,32],[77,23,69,33],[78,10,70,20,"setProfile"],[78,20,70,30],[78,21,70,31],[78,25,70,35],[78,26,70,36],[79,10,71,20,"setLoading"],[79,20,71,30],[79,21,71,31],[79,26,71,36],[79,27,71,37],[80,8,72,16],[81,6,73,12],[81,7,74,8],[81,8,74,9],[82,6,76,8],[82,13,76,15],[82,19,76,21,"subscription"],[82,31,76,33],[82,32,76,34,"unsubscribe"],[82,43,76,45],[82,44,76,46],[82,45,76,47],[83,4,77,4],[83,5,77,5],[83,7,77,7],[83,9,77,9],[83,10,77,10],[85,4,79,4],[86,4,80,4],[86,10,80,10,"fetchProfile"],[86,22,80,22],[86,25,80,25],[86,31,80,32,"userId"],[86,37,80,46],[86,41,80,69],[87,6,81,8],[87,10,81,12],[88,8,82,12,"console"],[88,15,82,19],[88,16,82,20,"log"],[88,19,82,23],[88,20,82,24],[88,46,82,50],[88,48,82,52,"userId"],[88,54,82,58],[88,55,82,59],[89,8,83,12],[89,14,83,18],[90,10,83,20,"data"],[90,14,83,24],[91,10,83,26,"error"],[92,8,83,32],[92,9,83,33],[92,12,83,36],[92,18,83,42,"supabase"],[92,35,83,50],[92,36,83,50,"supabase"],[92,44,83,50],[92,45,84,17,"from"],[92,49,84,21],[92,50,84,22],[92,60,84,32],[92,61,84,33],[92,62,85,17,"select"],[92,68,85,23],[92,69,85,24],[92,72,85,27],[92,73,85,28],[92,74,86,17,"eq"],[92,76,86,19],[92,77,86,20],[92,81,86,24],[92,83,86,26,"userId"],[92,89,86,32],[92,90,86,33],[92,91,87,17,"single"],[92,97,87,23],[92,98,87,24],[92,99,87,25],[93,8,89,12],[93,12,89,16,"data"],[93,16,89,20],[93,20,89,24],[93,21,89,25,"error"],[93,26,89,30],[93,28,89,32],[94,10,90,16,"console"],[94,17,90,23],[94,18,90,24,"log"],[94,21,90,27],[94,22,90,28],[94,40,90,46],[94,42,90,48,"data"],[94,46,90,52],[94,47,90,53,"email"],[94,52,90,58],[94,53,90,59],[95,10,91,16,"setProfile"],[95,20,91,26],[95,21,91,27,"data"],[95,25,91,31],[95,26,91,32],[96,10,92,16],[96,17,92,23],[96,21,92,27],[97,8,93,12],[97,9,93,13],[97,15,93,19],[98,10,94,16,"console"],[98,17,94,23],[98,18,94,24,"log"],[98,21,94,27],[98,22,94,28],[98,42,94,48],[98,43,94,49],[99,10,95,16,"setProfile"],[99,20,95,26],[99,21,95,27],[99,25,95,31],[99,26,95,32],[100,10,96,16],[100,17,96,23],[100,22,96,28],[101,8,97,12],[102,6,98,8],[102,7,98,9],[102,8,98,10],[102,15,98,17,"error"],[102,20,98,22],[102,22,98,24],[103,8,99,12,"console"],[103,15,99,19],[103,16,99,20,"error"],[103,21,99,25],[103,22,99,26],[103,47,99,51],[103,49,99,53,"error"],[103,54,99,58],[103,55,99,59],[104,8,100,12,"setProfile"],[104,18,100,22],[104,19,100,23],[104,23,100,27],[104,24,100,28],[105,8,101,12],[105,15,101,19],[105,20,101,24],[106,6,102,8],[107,4,103,4],[107,5,103,5],[108,4,105,4],[108,10,105,10,"signOut"],[108,17,105,17],[108,20,105,20],[108,26,105,20,"signOut"],[108,27,105,20],[108,32,105,32],[109,6,106,8],[109,10,106,12],[110,8,107,12,"setSession"],[110,18,107,22],[110,19,107,23],[110,23,107,27],[110,24,107,28],[111,8,108,12,"setUser"],[111,15,108,19],[111,16,108,20],[111,20,108,24],[111,21,108,25],[112,8,109,12,"setProfile"],[112,18,109,22],[112,19,109,23],[112,23,109,27],[112,24,109,28],[113,8,110,12],[113,14,110,18,"supabase"],[113,31,110,26],[113,32,110,26,"supabase"],[113,40,110,26],[113,41,110,27,"auth"],[113,45,110,31],[113,46,110,32,"signOut"],[113,53,110,39],[113,54,110,40],[113,55,110,41],[114,6,111,8],[114,7,111,9],[114,8,111,10],[114,15,111,17,"error"],[114,20,111,22],[114,22,111,24],[115,8,112,12,"console"],[115,15,112,19],[115,16,112,20,"error"],[115,21,112,25],[115,22,112,26],[115,42,112,46],[115,44,112,48,"error"],[115,49,112,53],[115,50,112,54],[116,6,113,8],[117,4,114,4],[117,5,114,5],[118,4,116,4],[118,10,116,10,"value"],[118,15,116,15],[118,18,116,18],[119,6,117,8,"session"],[119,13,117,15],[120,6,118,8,"user"],[120,10,118,12],[121,6,119,8,"profile"],[121,13,119,15],[122,6,120,8,"loading"],[122,13,120,15],[123,6,121,8,"signOut"],[124,4,122,4],[124,5,122,5],[125,4,124,4],[125,24,124,11],[125,28,124,11,"_reactJsxDevRuntime"],[125,47,124,11],[125,48,124,11,"jsxDEV"],[125,54,124,11],[125,56,124,12,"AuthContext"],[125,67,124,23],[125,68,124,24,"Provider"],[125,76,124,32],[126,6,124,33,"value"],[126,11,124,38],[126,13,124,40,"value"],[126,18,124,46],[127,6,124,46,"children"],[127,14,124,46],[127,16,124,48,"children"],[128,4,124,56],[129,6,124,56,"fileName"],[129,14,124,56],[129,16,124,56,"_jsxFileName"],[129,28,124,56],[130,6,124,56,"lineNumber"],[130,16,124,56],[131,6,124,56,"columnNumber"],[131,18,124,56],[132,4,124,56],[132,11,124,79],[132,12,124,80],[133,2,125,0],[134,2,125,1,"_s"],[134,4,125,1],[134,5,15,16,"AuthProvider"],[134,17,15,28],[135,2,15,28,"_c"],[135,4,15,28],[135,7,15,16,"AuthProvider"],[135,19,15,28],[136,2,127,7],[136,11,127,16,"useAuth"],[136,18,127,23,"useAuth"],[136,19,127,23],[136,21,127,26],[137,4,127,26,"_s2"],[137,7,127,26],[138,4,128,4],[138,10,128,10,"context"],[138,17,128,17],[138,20,128,20],[138,24,128,20,"useContext"],[138,30,128,30],[138,31,128,30,"useContext"],[138,41,128,30],[138,43,128,31,"AuthContext"],[138,54,128,42],[138,55,128,43],[139,4,129,4],[139,8,129,8,"context"],[139,15,129,15],[139,20,129,20,"undefined"],[139,29,129,29],[139,31,129,31],[140,6,130,8],[140,12,130,14],[140,16,130,18,"Error"],[140,21,130,23],[140,22,130,24],[140,67,130,69],[140,68,130,70],[141,4,131,4],[142,4,132,4],[142,11,132,11,"context"],[142,18,132,18],[143,2,133,0],[144,2,133,1,"_s2"],[144,5,133,1],[144,6,127,16,"useAuth"],[144,13,127,23],[145,2,127,23],[145,6,127,23,"_c"],[145,8,127,23],[146,2,127,23,"$RefreshReg$"],[146,14,127,23],[146,15,127,23,"_c"],[146,17,127,23],[147,0,127,23],[147,3]],"functionMap":{"names":["<global>","AuthProvider","useEffect$argument_0","supabase.auth.getSession.then$argument_0","supabase.auth.onAuthStateChange$argument_0","<anonymous>","fetchProfile","signOut","useAuth"],"mappings":"AAA;OCc;cCM;wCCQ;SDkB;YEI;aFsB;eGG,gCH;KDC;yBKG;KLuB;oBME;KNS;CDW;OQE;CRM"},"hasCjsExports":false},"type":"js/module"}]}